#!/bin/bash
install_step() {
    # Only run a step if it exists
    [ -f "stages/$1" ] && . "stages/$1"
}

# definition of tools (like $LSPCI) as well as command options parsing and
# options like installation path. It's a special case as it needs to be able to
# access the commandline options, therefore do not use install_step
. stages/setvars

install_step checkprivileges

install_step determinedistro
echo "${DISTRO}-based distribution found"

# optional distro-specific variables, like paths
install_step "$DISTRO/setvars"

install_step welcome

echo "== Checking dependencies =="
install_step "$DISTRO/checkdependencies"

echo "== Removing previous version =="
install_step uninstall

echo "== Detecting hardware =="
install_step detecthardware

echo "== Installing Bumblebee =="
install_step copyfiles
install_step "$DISTRO/copyfiles"

echo "== Configuring =="
install_step configure
